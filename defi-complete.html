<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HCF DeFi Platform - å®Œæ•´ç‰ˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px 30px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .nav-tabs {
            display: flex;
            gap: 15px;
            background: white;
            padding: 10px;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        .nav-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 16px;
            border-radius: 8px;
            transition: all 0.3s;
            white-space: nowrap;
        }
        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .page-content {
            display: none;
        }
        .page-content.active {
            display: block;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        .card-title {
            font-size: 14px;
            color: #888;
            margin-bottom: 8px;
        }
        .card-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .card-suffix {
            font-size: 14px;
            color: #667eea;
            margin-left: 5px;
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
        }
        .btn-success {
            background: linear-gradient(135deg, #26de81 0%, #20bf6b 100%);
        }
        .btn-warning {
            background: linear-gradient(135deg, #ffa502 0%, #ff6348 100%);
        }
        .input-group {
            margin: 20px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .progress {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin: 0 5px;
        }
        .badge-success {
            background: #e8f5e9;
            color: #4caf50;
        }
        .badge-warning {
            background: #fff3e0;
            color: #ff9800;
        }
        .badge-danger {
            background: #ffebee;
            color: #f44336;
        }
        .badge-info {
            background: #e3f2fd;
            color: #2196f3;
        }
        .badge-purple {
            background: #f3e5f5;
            color: #9c27b0;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }
        .info-box {
            background: #f0f8ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .error-box {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .stat-label {
            color: #666;
        }
        .stat-value {
            font-weight: bold;
            color: #333;
        }
        .node-level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .node-level-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }
        .node-level-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
        }
        .node-level-card.active {
            border-color: #667eea;
            background: #f8f9ff;
        }
        .dividend-pool {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .dividend-pool-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .dividend-pool-name {
            font-weight: bold;
            color: #333;
        }
        .dividend-pool-amount {
            color: #667eea;
            font-weight: bold;
        }
        .team-member-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 10px 0;
        }
        .team-member-rank {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .team-member-info {
            flex: 1;
            margin: 0 15px;
        }
        .team-member-address {
            font-family: monospace;
            font-size: 14px;
            color: #666;
        }
        .team-member-performance {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }
        .team-member-reward {
            text-align: right;
        }
        .team-member-reward-amount {
            color: #4caf50;
            font-weight: bold;
        }
        .team-level-table {
            width: 100%;
            margin: 20px 0;
        }
        .team-level-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin: 10px 0;
            transition: all 0.3s;
        }
        .team-level-row:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        .team-level-row.achieved {
            background: #e8f5e9;
            border-color: #4caf50;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .online-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .online-indicator.online {
            background: #4caf50;
            animation: pulse 2s infinite;
        }
        .online-indicator.offline {
            background: #f44336;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">ğŸš€ HCF DeFi Platform</div>
            <div id="wallet-status">
                <button class="btn" onclick="connectWallet()">è¿æ¥é’±åŒ…</button>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchPage('dashboard')">ğŸ“Š ä»ªè¡¨ç›˜</button>
            <button class="nav-tab" onclick="switchPage('staking')">ğŸ’° è´¨æŠ¼æ± </button>
            <button class="nav-tab" onclick="switchPage('nodenft')">ğŸ¨ èŠ‚ç‚¹NFT</button>
            <button class="nav-tab" onclick="switchPage('referral')">ğŸ‘¥ æ¨èç³»ç»Ÿ</button>
            <button class="nav-tab" onclick="switchPage('exchange')">ğŸ’± å…‘æ¢</button>
            <button class="nav-tab" onclick="switchPage('ranking')">ğŸ† æ’å</button>
            <button class="nav-tab" onclick="switchPage('governance')">ğŸ—³ï¸ æ²»ç†</button>
        </div>

        <!-- ä»ªè¡¨ç›˜é¡µé¢ï¼ˆç®€åŒ–ç‰ˆï¼‰ -->
        <div id="dashboard-page" class="page-content active">
            <h2 style="color: white; margin-bottom: 20px;">ä»ªè¡¨ç›˜</h2>
            <div class="grid">
                <div class="card">
                    <div class="card-title">HCF ä½™é¢</div>
                    <div class="card-value">
                        <span id="hcf-balance">0.00</span>
                        <span class="card-suffix">HCF</span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">BSDT ä½™é¢</div>
                    <div class="card-value">
                        <span id="bsdt-balance">0.00</span>
                        <span class="card-suffix">BSDT</span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">èŠ‚ç‚¹æ•°é‡</div>
                    <div class="card-value">
                        <span id="node-count">45</span> / 99
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">å›¢é˜Ÿç­‰çº§</div>
                    <div class="card-value">
                        <span id="team-level">V0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- è´¨æŠ¼æ± é¡µé¢ï¼ˆç®€åŒ–ç‰ˆï¼‰ -->
        <div id="staking-page" class="page-content">
            <h2 style="color: white; margin-bottom: 20px;">è´¨æŠ¼æ± </h2>
            <div class="card">
                <h3>è´¨æŠ¼åŠŸèƒ½</h3>
                <p>è´¨æŠ¼åŠŸèƒ½å·²åœ¨ defi-platform.html ä¸­å®ç°</p>
                <a href="/defi-platform.html" class="btn">è®¿é—®å®Œæ•´è´¨æŠ¼é¡µé¢</a>
            </div>
        </div>

        <!-- èŠ‚ç‚¹NFTé¡µé¢ -->
        <div id="nodenft-page" class="page-content">
            <h2 style="color: white; margin-bottom: 20px;">èŠ‚ç‚¹NFTç³»ç»Ÿ</h2>
            
            <!-- èŠ‚ç‚¹æ¦‚è§ˆ -->
            <div class="grid">
                <div class="card">
                    <div class="card-title">èŠ‚ç‚¹æ•°é‡</div>
                    <div class="card-value">
                        <span id="total-nodes">45</span> / 99
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 45.5%;"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ç”³è¯·è´¹ç”¨</div>
                    <div class="card-value">
                        <span id="apply-fee">5000</span>
                        <span class="card-suffix" id="apply-currency">BSDT</span>
                    </div>
                    <small>ä»·æ ¼ < 1.3 ç”¨BSDT, å¦åˆ™ç”¨HCF</small>
                </div>
                <div class="card">
                    <div class="card-title">æ¿€æ´»è´¹ç”¨</div>
                    <div class="card-value">
                        2000 <span class="card-suffix">HCF</span>
                    </div>
                    <small>1000 HCF + 1000 HCF/BSDT LP</small>
                </div>
            </div>

            <!-- æˆ‘çš„èŠ‚ç‚¹ä¿¡æ¯ -->
            <div class="card">
                <h3>æˆ‘çš„èŠ‚ç‚¹ä¿¡æ¯</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">èŠ‚ç‚¹ID</span>
                        <span class="stat-value" id="my-node-id">#æœªæŒæœ‰</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">èŠ‚ç‚¹ç­‰çº§</span>
                        <span class="stat-value" id="my-node-level">æ— </span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ç®—åŠ›</span>
                        <span class="stat-value" id="my-node-power">0%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">åœ¨çº¿ç‡</span>
                        <span class="stat-value" id="my-online-rate">
                            <span class="online-indicator offline"></span>
                            0%
                        </span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">æŒå¸é‡</span>
                        <span class="stat-value" id="my-holding">0 HCF</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">æ»¡å€¼</span>
                        <span class="stat-value" id="max-value">1000 HCF</span>
                    </div>
                </div>
                
                <div class="info-box">
                    <strong>ç®—åŠ›è§„åˆ™ï¼š</strong><br>
                    â€¢ åŸºç¡€ç®—åŠ›: 99.9%<br>
                    â€¢ æŒå¸é‡ < 1000 HCF: ä¸å¢åŠ ç®—åŠ›<br>
                    â€¢ æŒå¸é‡ > 1000 HCF: æ¯1000 HCFå¢åŠ 1%ç®—åŠ›<br>
                    â€¢ åœ¨çº¿ç‡ > 90%: è·å¾—åˆ†çº¢æƒ
                </div>
            </div>

            <!-- èŠ‚ç‚¹ç­‰çº§ -->
            <div class="card">
                <h3>èŠ‚ç‚¹ç­‰çº§ç³»ç»Ÿ</h3>
                <div class="node-level-grid">
                    <div class="node-level-card">
                        <h4>è½»é‡èŠ‚ç‚¹</h4>
                        <div class="badge badge-success">10,000 HCF</div>
                        <ul style="text-align: left; margin-top: 10px; font-size: 14px;">
                            <li>+20% æ”¶ç›ŠåŠ æˆ</li>
                            <li>æ²»ç†æƒé‡ x1</li>
                            <li>æ’å +500åˆ†</li>
                            <li>ä¼˜å…ˆæ–°åŠŸèƒ½</li>
                        </ul>
                    </div>
                    <div class="node-level-card">
                        <h4>æ ‡å‡†èŠ‚ç‚¹</h4>
                        <div class="badge badge-info">50,000 HCF</div>
                        <ul style="text-align: left; margin-top: 10px; font-size: 14px;">
                            <li>+30% æ”¶ç›ŠåŠ æˆ</li>
                            <li>æ²»ç†æƒé‡ x2</li>
                            <li>æ’å +1000åˆ†</li>
                            <li>ä¼˜å…ˆæ–°åŠŸèƒ½</li>
                        </ul>
                    </div>
                    <div class="node-level-card">
                        <h4>é«˜çº§èŠ‚ç‚¹</h4>
                        <div class="badge badge-warning">200,000 HCF</div>
                        <ul style="text-align: left; margin-top: 10px; font-size: 14px;">
                            <li>+40% æ”¶ç›ŠåŠ æˆ</li>
                            <li>æ²»ç†æƒé‡ x3</li>
                            <li>æ’å +2000åˆ†</li>
                            <li>ä¼˜å…ˆæ–°åŠŸèƒ½</li>
                        </ul>
                    </div>
                    <div class="node-level-card">
                        <h4>è¶…çº§èŠ‚ç‚¹</h4>
                        <div class="badge badge-danger">500,000 HCF</div>
                        <ul style="text-align: left; margin-top: 10px; font-size: 14px;">
                            <li>+50% æ”¶ç›ŠåŠ æˆ</li>
                            <li>æ²»ç†æƒé‡ x5</li>
                            <li>æ’å +5000åˆ†</li>
                            <li>ä¼˜å…ˆæ–°åŠŸèƒ½</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- åˆ†çº¢æ±  -->
            <div class="card">
                <h3>åˆ†çº¢æ± ï¼ˆæŒ‰ç®—åŠ›åˆ†é…ï¼‰</h3>
                <div class="dividend-pool">
                    <div class="dividend-pool-header">
                        <span class="dividend-pool-name">ğŸ”„ æ»‘ç‚¹åˆ†çº¢æ± </span>
                        <span class="dividend-pool-amount">10,000 HCF</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 70%;"></div>
                    </div>
                    <small>æ¥æºï¼šäº¤æ˜“æ»‘ç‚¹æ”¶ç›Š</small>
                </div>
                <div class="dividend-pool">
                    <div class="dividend-pool-header">
                        <span class="dividend-pool-name">ğŸ’¸ æç°æ‰‹ç»­è´¹æ± </span>
                        <span class="dividend-pool-amount">5,000 HCF</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 50%;"></div>
                    </div>
                    <small>æ¥æºï¼šæç°æ‰‹ç»­è´¹</small>
                </div>
                <div class="dividend-pool">
                    <div class="dividend-pool-header">
                        <span class="dividend-pool-name">ğŸ’° å…¥é‡‘æ‰‹ç»­è´¹æ± </span>
                        <span class="dividend-pool-amount">8,000 HCF</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 60%;"></div>
                    </div>
                    <small>æ¥æºï¼šå…¥é‡‘æ‰‹ç»­è´¹</small>
                </div>
                <div class="dividend-pool">
                    <div class="dividend-pool-header">
                        <span class="dividend-pool-name">ğŸ›¡ï¸ é˜²ç ¸ç›˜ä¿æŠ¤æ± </span>
                        <span class="dividend-pool-amount">3,000 HCF</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 30%;"></div>
                    </div>
                    <small>æ¥æºï¼šå¤§é¢å–å‡ºæƒ©ç½š</small>
                </div>
                
                <div class="success-box" style="margin-top: 20px;">
                    <strong>å¾…é¢†å–åˆ†çº¢ï¼š</strong>
                    <span id="pending-dividends" style="font-size: 20px; font-weight: bold;">1,234.56 HCF</span>
                </div>
            </div>

            <!-- æ— å¸¸æŸå¤±è¡¥å¿ -->
            <div class="card">
                <h3>æ— å¸¸æŸå¤±è¡¥å¿</h3>
                <div class="warning-box">
                    å½“å‰æ— å¸¸æŸå¤±: <strong>-500 HCF</strong><br>
                    æœ€å°è¡¥å¿é¢: <strong>500 HCF</strong><br>
                    ä¼˜å…ˆçº§åŠ æˆ: <strong>+20%</strong>
                </div>
                <button class="btn btn-success" onclick="claimNodeCompensation()">
                    ç”³è¯·è¡¥å¿ (æ¢å¤ä¼˜å…ˆ+20%)
                </button>
            </div>

            <!-- æ»¡å€¼è°ƒæ•´ï¼ˆå¤šç­¾ï¼‰ -->
            <div class="card">
                <h3>æ»¡å€¼è°ƒæ•´ï¼ˆéœ€è¦å¤šç­¾ï¼‰</h3>
                <div class="info-box">
                    å½“å‰æ»¡å€¼: <strong>1000 HCF</strong><br>
                    å»ºè®®è°ƒæ•´: <strong>500 HCF</strong><br>
                    çŠ¶æ€: å…¨ç½‘ç»Ÿä¸€è°ƒæ•´
                </div>
                <div class="input-group">
                    <label>æ–°æ»¡å€¼è®¾å®š</label>
                    <input type="number" id="new-max-value" placeholder="è¾“å…¥æ–°çš„æ»¡å€¼">
                </div>
                <button class="btn btn-warning" onclick="proposeMaxValueChange()">
                    æè®®æ»¡å€¼è°ƒæ•´ï¼ˆéœ€3/5å¤šç­¾ï¼‰
                </button>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="card">
                <h3>èŠ‚ç‚¹æ“ä½œ</h3>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <button class="btn" onclick="applyForNode()">ç”³è¯·èŠ‚ç‚¹</button>
                    <button class="btn btn-success" onclick="activateNode()">æ¿€æ´»èŠ‚ç‚¹</button>
                    <button class="btn btn-secondary" onclick="updateNodePower()">æ›´æ–°ç®—åŠ›</button>
                    <button class="btn btn-warning" onclick="claimDividends()">é¢†å–åˆ†çº¢</button>
                    <button class="btn" onclick="showVoteModal()">æ²»ç†æŠ•ç¥¨</button>
                </div>
            </div>
        </div>

        <!-- æ¨èç³»ç»Ÿé¡µé¢ -->
        <div id="referral-page" class="page-content">
            <h2 style="color: white; margin-bottom: 20px;">æ¨èç³»ç»Ÿ</h2>
            
            <!-- æ¨èæ¦‚è§ˆ -->
            <div class="grid">
                <div class="card">
                    <div class="card-title">ç›´æ¨äººæ•°</div>
                    <div class="card-value">
                        <span id="direct-referrals">0</span>
                        <span class="card-suffix">äºº</span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">å›¢é˜Ÿç­‰çº§</div>
                    <div class="card-value">
                        <span id="team-level-display">V0</span>
                        <span class="badge badge-info" id="team-badge">æœªæ¿€æ´»</span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">æ€»ä¸šç»©</div>
                    <div class="card-value">
                        <span id="total-performance">0</span>
                        <span class="card-suffix">HCF</span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">æ€»æ”¶ç›Š</div>
                    <div class="card-value" style="color: #4caf50;">
                        <span id="total-referral-income">0</span>
                        <span class="card-suffix">HCF</span>
                    </div>
                </div>
            </div>

            <!-- æ¨èé“¾æ¥ -->
            <div class="card">
                <h3>æˆ‘çš„æ¨èé“¾æ¥</h3>
                <div class="input-group">
                    <input type="text" id="referral-link" readonly value="https://hcf-finance.xyz?ref=0x0000" style="font-family: monospace;">
                    <button class="btn btn-secondary" onclick="copyReferralLink()" style="margin-top: 10px;">
                        å¤åˆ¶é“¾æ¥
                    </button>
                </div>
                <div class="success-box">
                    åˆ†äº«æ­¤é“¾æ¥ï¼Œæ–°ç”¨æˆ·æ³¨å†Œå¹¶è´¨æŠ¼åï¼Œæ‚¨å°†è·å¾—æ¨èå¥–åŠ±ï¼
                </div>
            </div>

            <!-- å›¢é˜Ÿç­‰çº§ç³»ç»Ÿ -->
            <div class="card">
                <h3>å›¢é˜Ÿç­‰çº§è¦æ±‚</h3>
                <div class="team-level-table">
                    <div class="team-level-row" id="level-v1">
                        <div>
                            <strong>V1</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 2,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 6%
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                    <div class="team-level-row" id="level-v2">
                        <div>
                            <strong>V2</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 20,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 12%<br>
                                éœ€è¦: 1ä¸ªV1
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                    <div class="team-level-row" id="level-v3">
                        <div>
                            <strong>V3</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 200,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 18%<br>
                                éœ€è¦: 2ä¸ªV2
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                    <div class="team-level-row" id="level-v4">
                        <div>
                            <strong>V4</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 2,000,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 24%<br>
                                éœ€è¦: 2ä¸ªV3
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                    <div class="team-level-row" id="level-v5">
                        <div>
                            <strong>V5</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 5,000,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 30%<br>
                                éœ€è¦: 2ä¸ªV4
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                    <div class="team-level-row" id="level-v6">
                        <div>
                            <strong>V6</strong>
                            <div style="font-size: 14px; color: #666;">
                                å°åŒºä¸šç»©: 20,000,000 HCF<br>
                                å¥–åŠ±æ¯”ä¾‹: 36%<br>
                                éœ€è¦: 3ä¸ªV5
                            </div>
                        </div>
                        <div>
                            <span class="badge badge-danger">æœªè¾¾æˆ</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å›¢é˜Ÿæˆå‘˜åˆ—è¡¨ -->
            <div class="card">
                <h3>å›¢é˜Ÿæˆå‘˜</h3>
                <div id="team-members-list">
                    <div class="team-member-item">
                        <div class="team-member-rank">1</div>
                        <div class="team-member-info">
                            <div class="team-member-address">0x1234...5678</div>
                            <div class="team-member-performance">ä¸šç»©: 10,000 HCF</div>
                        </div>
                        <div class="team-member-reward">
                            <div class="team-member-reward-amount">+500 HCF</div>
                            <div style="font-size: 12px; color: #999;">å¥–åŠ±</div>
                        </div>
                    </div>
                    <div class="team-member-item">
                        <div class="team-member-rank">2</div>
                        <div class="team-member-info">
                            <div class="team-member-address">0xabcd...efgh</div>
                            <div class="team-member-performance">ä¸šç»©: 8,000 HCF</div>
                        </div>
                        <div class="team-member-reward">
                            <div class="team-member-reward-amount">+400 HCF</div>
                            <div style="font-size: 12px; color: #999;">å¥–åŠ±</div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="loadMoreMembers()" style="width: 100%; margin-top: 10px;">
                    æŸ¥çœ‹æ›´å¤š
                </button>
            </div>

            <!-- æœ€æ–°æ¨è -->
            <div class="card">
                <h3>æœ€æ–°æ¨è</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>æ—¶é—´</th>
                            <th>ç”¨æˆ·</th>
                            <th>é‡‘é¢</th>
                            <th>çŠ¶æ€</th>
                        </tr>
                    </thead>
                    <tbody id="recent-referrals">
                        <tr>
                            <td>2åˆ†é’Ÿå‰</td>
                            <td>0x9876...5432</td>
                            <td>1,000 HCF</td>
                            <td><span class="badge badge-success">å·²æ¿€æ´»</span></td>
                        </tr>
                        <tr>
                            <td>1å°æ—¶å‰</td>
                            <td>0x5555...6666</td>
                            <td>5,000 HCF</td>
                            <td><span class="badge badge-success">å·²æ¿€æ´»</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- åŠ¨æ€æ”¶ç›Šå’Œé”€æ¯ -->
            <div class="grid">
                <div class="card">
                    <h3>åŠ¨æ€æ”¶ç›Šæ¯”</h3>
                    <div style="text-align: center;">
                        <div style="font-size: 36px; font-weight: bold; color: #667eea;">70%</div>
                        <div style="margin-top: 10px;">
                            <div>åŸºç¡€: 1000 HCF</div>
                            <div>å®é™…: 700 HCF</div>
                            <div style="font-size: 12px; color: #999;">åº”ç”¨äº20ä»£çº§å·®</div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3>é”€æ¯æç¤º</h3>
                    <div class="error-box">
                        æ¨èå¥–åŠ±é”€æ¯: <strong>10%</strong><br>
                        å›¢é˜Ÿå¥–åŠ±é”€æ¯: <strong>5%</strong>
                    </div>
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="card">
                <h3>æ¨èæ“ä½œ</h3>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <button class="btn" onclick="registerReferral()">ç™»è®°æ¨èäºº</button>
                    <button class="btn btn-secondary" onclick="generateNewLink()">ç”Ÿæˆæ–°é“¾æ¥</button>
                    <button class="btn btn-success" onclick="upgradeTeamLevel()">å‡çº§å›¢é˜Ÿç­‰çº§</button>
                    <button class="btn btn-warning" onclick="claimReferralReward()">é¢†å–æ¨èå¥–åŠ±</button>
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    <strong>å¾…é¢†å–å¥–åŠ±ï¼š</strong>
                    <span id="pending-referral-reward" style="font-size: 20px; font-weight: bold; color: #4caf50;">
                        888.88 HCF
                    </span>
                </div>
            </div>
        </div>

        <!-- å…¶ä»–é¡µé¢å ä½ -->
        <div id="exchange-page" class="page-content">
            <div class="card">
                <h2>å…‘æ¢</h2>
                <p>å…‘æ¢åŠŸèƒ½å¼€å‘ä¸­...</p>
            </div>
        </div>

        <div id="ranking-page" class="page-content">
            <div class="card">
                <h2>æ’å</h2>
                <p>æ’ååŠŸèƒ½å¼€å‘ä¸­...</p>
            </div>
        </div>

        <div id="governance-page" class="page-content">
            <div class="card">
                <h2>æ²»ç†</h2>
                <p>æ²»ç†åŠŸèƒ½å¼€å‘ä¸­...</p>
            </div>
        </div>
    </div>

    <!-- åŠ è½½Ethers.js -->
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    
    <script>
        // åˆçº¦åœ°å€
        const CONTRACTS = {
            HCF: '0x09F320b75e6A74994713a0e4Be54eF8f09fbaEcc',
            BSDT: '0x622e568976f6cC2eaE4cfd3836d92F111000E787',
            NodeNFT: '0xFCd9c088f387C2C5a4ef87b87bde979a6EaAbA15',
            Referral: '0x4DBDcfC87D528F616e5B11b9bc84e7C00F0Fc674',
            Staking: '0x6E4e682Cc90124Ef66a8cfC8Fc875CF5Ee8E8a74',
            Governance: '0xEe96926C972d55dD5577cB6C5db04BcdC8Eb1629'
        };

        // ABIå®šä¹‰
        const HCF_ABI = [
            "function balanceOf(address) view returns (uint256)",
            "function totalSupply() view returns (uint256)",
            "function approve(address spender, uint256 amount) returns (bool)",
            "function transfer(address to, uint256 amount) returns (bool)"
        ];

        const BSDT_ABI = [
            "function balanceOf(address) view returns (uint256)",
            "function approve(address spender, uint256 amount) returns (bool)"
        ];

        const NODE_NFT_ABI = [
            "function mintNode() returns (uint256)",
            "function activateNode(uint256 tokenId) returns (bool)",
            "function updateNodePower(uint256 tokenId) returns (bool)",
            "function claimDividends() returns (bool)",
            "function balanceOf(address) view returns (uint256)",
            "function totalSupply() view returns (uint256)",
            "function getNodeInfo(uint256 tokenId) view returns (tuple(uint256 power, uint256 level, bool isActive, uint256 rewards, uint256 lastClaim))",
            "function NODE_PRICE() view returns (uint256)"
        ];

        const REFERRAL_ABI = [
            "function register(address referrer) returns (bool)",
            "function claimReferralReward() returns (bool)",
            "function getUserData(address user) view returns (tuple(address referrer, uint256 directCount, uint256 teamLevel, uint256 personalVolume, uint256 teamVolume, uint256 totalReferralReward, uint256 totalTeamReward, uint256 claimableReferralReward, uint256 claimableTeamReward))",
            "function updateTeamLevel() returns (bool)"
        ];

        // å…¨å±€å˜é‡
        let provider = null;
        let signer = null;
        let account = null;
        let connected = false;
        let currentPrice = 1.0;

        // é¡µé¢åˆ‡æ¢
        function switchPage(page) {
            document.querySelectorAll('.page-content').forEach(p => {
                p.classList.remove('active');
            });
            document.getElementById(`${page}-page`).classList.add('active');
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // åŠ è½½å¯¹åº”é¡µé¢æ•°æ®
            if (connected) {
                if (page === 'nodenft') {
                    loadNodeData();
                } else if (page === 'referral') {
                    loadReferralData();
                }
            }
        }

        // è¿æ¥é’±åŒ…
        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('è¯·å®‰è£… MetaMask é’±åŒ…');
                    return;
                }

                provider = new ethers.providers.Web3Provider(window.ethereum);
                const accounts = await provider.send("eth_requestAccounts", []);
                
                if (accounts.length === 0) {
                    throw new Error('æ²¡æœ‰æ‰¾åˆ°è´¦æˆ·');
                }
                
                account = accounts[0];
                signer = provider.getSigner();
                connected = true;
                
                // æ£€æŸ¥ç½‘ç»œ
                const network = await provider.getNetwork();
                if (network.chainId !== 97) {
                    await switchToBSCTestnet();
                }
                
                // æ›´æ–°UI
                document.getElementById('wallet-status').innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: #4caf50;">â—</span>
                        <span>${account.substring(0, 6)}...${account.substring(38)}</span>
                        <button class="btn btn-secondary" onclick="disconnect()">æ–­å¼€</button>
                    </div>
                `;
                
                // ç”Ÿæˆæ¨èé“¾æ¥
                document.getElementById('referral-link').value = `https://hcf-finance.xyz?ref=${account}`;
                
                // åŠ è½½æ•°æ®
                await loadAllData();
                
                // è®¢é˜…äº‹ä»¶
                subscribeToEvents();
                
            } catch (error) {
                console.error('è¿æ¥å¤±è´¥:', error);
                alert('è¿æ¥å¤±è´¥: ' + error.message);
            }
        }

        // åˆ‡æ¢åˆ°BSCæµ‹è¯•ç½‘
        async function switchToBSCTestnet() {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x61' }],
                });
            } catch (switchError) {
                if (switchError.code === 4902) {
                    await window.ethereum.request({
                        method: 'wallet_addEthereumChain',
                        params: [{
                            chainId: '0x61',
                            chainName: 'BSC Testnet',
                            nativeCurrency: {
                                name: 'BNB',
                                symbol: 'BNB',
                                decimals: 18
                            },
                            rpcUrls: ['https://data-seed-prebsc-1-s1.binance.org:8545/'],
                            blockExplorerUrls: ['https://testnet.bscscan.com/']
                        }]
                    });
                }
            }
        }

        // åŠ è½½æ‰€æœ‰æ•°æ®
        async function loadAllData() {
            if (!connected) return;
            
            try {
                const hcfContract = new ethers.Contract(CONTRACTS.HCF, HCF_ABI, provider);
                const bsdtContract = new ethers.Contract(CONTRACTS.BSDT, BSDT_ABI, provider);
                
                const [hcfBalance, bsdtBalance] = await Promise.all([
                    hcfContract.balanceOf(account),
                    bsdtContract.balanceOf(account)
                ]);
                
                document.getElementById('hcf-balance').textContent = ethers.utils.formatUnits(hcfBalance, 18).slice(0, 10);
                document.getElementById('bsdt-balance').textContent = ethers.utils.formatUnits(bsdtBalance, 18).slice(0, 10);
                
                await loadNodeData();
                await loadReferralData();
                
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
            }
        }

        // åŠ è½½èŠ‚ç‚¹æ•°æ®
        async function loadNodeData() {
            if (!connected) return;
            
            try {
                const nodeContract = new ethers.Contract(CONTRACTS.NODE_NFT_ABI, NODE_NFT_ABI, provider);
                
                const [nodeBalance, totalNodes] = await Promise.all([
                    nodeContract.balanceOf(account),
                    nodeContract.totalSupply()
                ]);
                
                document.getElementById('total-nodes').textContent = totalNodes.toString();
                document.getElementById('node-count').textContent = totalNodes.toString();
                
                if (nodeBalance > 0) {
                    // è·å–ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯
                    const nodeInfo = await nodeContract.getNodeInfo(0);
                    document.getElementById('my-node-id').textContent = '#1';
                    document.getElementById('my-node-power').textContent = (nodeInfo.power || 100) + '%';
                    
                    // æ ¹æ®poweråˆ¤æ–­ç­‰çº§
                    const power = nodeInfo.power || 100;
                    let level = 'è½»é‡èŠ‚ç‚¹';
                    if (power >= 500) level = 'è¶…çº§èŠ‚ç‚¹';
                    else if (power >= 300) level = 'é«˜çº§èŠ‚ç‚¹';
                    else if (power >= 200) level = 'æ ‡å‡†èŠ‚ç‚¹';
                    document.getElementById('my-node-level').textContent = level;
                    
                    // æ›´æ–°åœ¨çº¿çŠ¶æ€
                    const onlineRate = 95; // æ¨¡æ‹Ÿåœ¨çº¿ç‡
                    document.getElementById('my-online-rate').innerHTML = `
                        <span class="online-indicator ${onlineRate > 90 ? 'online' : 'offline'}"></span>
                        ${onlineRate}%
                    `;
                }
                
                // æ›´æ–°ä»·æ ¼å†³å®šä½¿ç”¨çš„è´§å¸
                currentPrice = 1.0; // ä»Oracleè·å–
                if (currentPrice < 1.3) {
                    document.getElementById('apply-currency').textContent = 'BSDT';
                } else {
                    document.getElementById('apply-currency').textContent = 'HCF';
                }
                
            } catch (error) {
                console.error('åŠ è½½èŠ‚ç‚¹æ•°æ®å¤±è´¥:', error);
            }
        }

        // åŠ è½½æ¨èæ•°æ®
        async function loadReferralData() {
            if (!connected) return;
            
            try {
                const referralContract = new ethers.Contract(CONTRACTS.Referral, REFERRAL_ABI, provider);
                const userData = await referralContract.getUserData(account);
                
                document.getElementById('direct-referrals').textContent = userData.directCount || '0';
                document.getElementById('team-level-display').textContent = `V${userData.teamLevel || 0}`;
                document.getElementById('team-level').textContent = `V${userData.teamLevel || 0}`;
                document.getElementById('total-performance').textContent = ethers.utils.formatUnits(userData.personalVolume || 0, 18).slice(0, 10);
                document.getElementById('total-referral-income').textContent = ethers.utils.formatUnits(userData.totalReferralReward || 0, 18).slice(0, 10);
                document.getElementById('pending-referral-reward').textContent = ethers.utils.formatUnits(userData.claimableReferralReward || 0, 18).slice(0, 10) + ' HCF';
                
                // æ›´æ–°å›¢é˜Ÿç­‰çº§è¾¾æˆçŠ¶æ€
                const teamLevel = Number(userData.teamLevel || 0);
                for (let i = 1; i <= 6; i++) {
                    const levelRow = document.getElementById(`level-v${i}`);
                    if (levelRow) {
                        if (i <= teamLevel) {
                            levelRow.classList.add('achieved');
                            levelRow.querySelector('.badge').textContent = 'å·²è¾¾æˆ';
                            levelRow.querySelector('.badge').className = 'badge badge-success';
                        }
                    }
                }
                
            } catch (error) {
                console.error('åŠ è½½æ¨èæ•°æ®å¤±è´¥:', error);
            }
        }

        // èŠ‚ç‚¹NFTåŠŸèƒ½
        async function applyForNode() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            try {
                const nodeContract = new ethers.Contract(CONTRACTS.NodeNFT, NODE_NFT_ABI, signer);
                const price = await nodeContract.NODE_PRICE();
                
                if (currentPrice < 1.3) {
                    // ä½¿ç”¨BSDTæ”¯ä»˜
                    const bsdtContract = new ethers.Contract(CONTRACTS.BSDT, BSDT_ABI, signer);
                    const approveTx = await bsdtContract.approve(CONTRACTS.NodeNFT, price);
                    await approveTx.wait();
                } else {
                    // ä½¿ç”¨HCFæ”¯ä»˜
                    const hcfContract = new ethers.Contract(CONTRACTS.HCF, HCF_ABI, signer);
                    const approveTx = await hcfContract.approve(CONTRACTS.NodeNFT, price);
                    await approveTx.wait();
                }
                
                const mintTx = await nodeContract.mintNode();
                await mintTx.wait();
                
                alert('èŠ‚ç‚¹ç”³è¯·æˆåŠŸï¼');
                await loadNodeData();
                
            } catch (error) {
                console.error('ç”³è¯·èŠ‚ç‚¹å¤±è´¥:', error);
                alert('ç”³è¯·å¤±è´¥: ' + error.message);
            }
        }

        async function activateNode() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            alert('éœ€è¦1000 HCF + 1000 HCF/BSDT LPï¼Œæ¿€æ´»åŠŸèƒ½å¼€å‘ä¸­...');
        }

        async function updateNodePower() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            try {
                const nodeContract = new ethers.Contract(CONTRACTS.NodeNFT, NODE_NFT_ABI, signer);
                const tx = await nodeContract.updateNodePower(0); // æ›´æ–°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                await tx.wait();
                
                alert('ç®—åŠ›æ›´æ–°æˆåŠŸï¼');
                await loadNodeData();
                
            } catch (error) {
                console.error('æ›´æ–°ç®—åŠ›å¤±è´¥:', error);
                alert('æ›´æ–°å¤±è´¥: ' + error.message);
            }
        }

        async function claimDividends() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            try {
                const nodeContract = new ethers.Contract(CONTRACTS.NodeNFT, NODE_NFT_ABI, signer);
                const tx = await nodeContract.claimDividends();
                await tx.wait();
                
                alert('åˆ†çº¢é¢†å–æˆåŠŸï¼');
                document.getElementById('pending-dividends').textContent = '0 HCF';
                
            } catch (error) {
                console.error('é¢†å–åˆ†çº¢å¤±è´¥:', error);
                alert('é¢†å–å¤±è´¥: ' + error.message);
            }
        }

        function showVoteModal() {
            alert('æ²»ç†æŠ•ç¥¨åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function claimNodeCompensation() {
            alert('æ— å¸¸æŸå¤±è¡¥å¿åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function proposeMaxValueChange() {
            const newValue = document.getElementById('new-max-value').value;
            if (!newValue) {
                alert('è¯·è¾“å…¥æ–°çš„æ»¡å€¼');
                return;
            }
            alert(`æè®®å°†æ»¡å€¼è°ƒæ•´ä¸º ${newValue} HCFï¼Œéœ€è¦3/5å¤šç­¾æ‰¹å‡†`);
        }

        // æ¨èç³»ç»ŸåŠŸèƒ½
        async function registerReferral() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            const referrer = prompt('è¯·è¾“å…¥æ¨èäººåœ°å€:');
            if (!referrer) return;
            
            try {
                const referralContract = new ethers.Contract(CONTRACTS.Referral, REFERRAL_ABI, signer);
                const tx = await referralContract.register(referrer);
                await tx.wait();
                
                alert('æ¨èäººç™»è®°æˆåŠŸï¼');
                
            } catch (error) {
                console.error('ç™»è®°å¤±è´¥:', error);
                alert('ç™»è®°å¤±è´¥: ' + error.message);
            }
        }

        function generateNewLink() {
            const timestamp = Date.now();
            const newLink = `https://hcf-finance.xyz?ref=${account}&t=${timestamp}`;
            document.getElementById('referral-link').value = newLink;
            alert('æ–°é“¾æ¥å·²ç”Ÿæˆï¼');
        }

        async function upgradeTeamLevel() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            try {
                const referralContract = new ethers.Contract(CONTRACTS.Referral, REFERRAL_ABI, signer);
                const tx = await referralContract.updateTeamLevel();
                await tx.wait();
                
                alert('å›¢é˜Ÿç­‰çº§å‡çº§æˆåŠŸï¼');
                await loadReferralData();
                
            } catch (error) {
                console.error('å‡çº§å¤±è´¥:', error);
                alert('å‡çº§å¤±è´¥: ' + error.message);
            }
        }

        async function claimReferralReward() {
            if (!connected) {
                alert('è¯·å…ˆè¿æ¥é’±åŒ…');
                return;
            }
            
            try {
                const referralContract = new ethers.Contract(CONTRACTS.Referral, REFERRAL_ABI, signer);
                const tx = await referralContract.claimReferralReward();
                await tx.wait();
                
                alert('æ¨èå¥–åŠ±é¢†å–æˆåŠŸï¼(å·²æ‰£é™¤10%é”€æ¯)');
                await loadReferralData();
                
            } catch (error) {
                console.error('é¢†å–å¤±è´¥:', error);
                alert('é¢†å–å¤±è´¥: ' + error.message);
            }
        }

        function copyReferralLink() {
            const link = document.getElementById('referral-link');
            link.select();
            document.execCommand('copy');
            alert('é“¾æ¥å·²å¤åˆ¶ï¼');
        }

        function loadMoreMembers() {
            alert('åŠ è½½æ›´å¤šå›¢é˜Ÿæˆå‘˜...');
        }

        // æ–­å¼€è¿æ¥
        function disconnect() {
            account = null;
            connected = false;
            provider = null;
            signer = null;
            
            document.getElementById('wallet-status').innerHTML = `
                <button class="btn" onclick="connectWallet()">è¿æ¥é’±åŒ…</button>
            `;
        }

        // è®¢é˜…äº‹ä»¶
        function subscribeToEvents() {
            if (!connected) return;
            
            const nodeContract = new ethers.Contract(CONTRACTS.NodeNFT, NODE_NFT_ABI, provider);
            const referralContract = new ethers.Contract(CONTRACTS.Referral, REFERRAL_ABI, provider);
            
            // ç›‘å¬èŠ‚ç‚¹æ¿€æ´»äº‹ä»¶
            nodeContract.on('NodeActivated', (owner, tokenId) => {
                if (owner === account) {
                    loadNodeData();
                }
            });
            
            // ç›‘å¬åˆ†çº¢é¢†å–äº‹ä»¶
            nodeContract.on('DividendsClaimed', (owner, amount) => {
                if (owner === account) {
                    loadNodeData();
                }
            });
            
            // ç›‘å¬æ¨èå¥–åŠ±äº‹ä»¶
            referralContract.on('RewardDistributed', (user, amount) => {
                if (user === account) {
                    loadReferralData();
                }
            });
        }

        // ç›‘å¬è´¦æˆ·å˜åŒ–
        if (window.ethereum) {
            window.ethereum.on('accountsChanged', (accounts) => {
                if (accounts.length === 0) {
                    disconnect();
                } else if (account !== accounts[0]) {
                    account = accounts[0];
                    connectWallet();
                }
            });
        }
    </script>
</body>
</html>